#include <gtest/gtest.h>
#include <sycl/sycl.hpp>
#include <vector>

#include "Configuration.hpp"
#include "MatrixMatrixOperations.hpp"
#include "MatrixParser.hpp"
#include "SymmetricMatrix.hpp"
#include "MatrixOperations.hpp"

using namespace sycl;

class TriangularSolveTest : public ::testing::Test {
public:
    std::string path_A = "../tests/testData/testMatrixSymmetric20x20.txt";

    std::vector<conf::fp_type> reference_full_column = {
        1.6657640408280994, 0., 0., 0.,
        -1.8673704908863058, 1.037699909127167, 0., 0.,
        0.1991461118312038, -0.07586948005704164, 0.5953893307710177, 0.,
        1.473522474945474, -0.5150608618535167, -0.11920226811930101, 0.8003267002247397,
        -1.6028097870197155, 0.7977386909867202, -0.08513639374705588, -0.22778431498644927,
        0.24420704350066558, -0.0308872636623833, 0.13677303345588004, 0.059250512704062584,
        -0.7287911051790122, 0.3896830234369213, -0.16375079990680444, 0.053903197318863505,
        -0.45233955570772905, 0.15289148266779432, 0.10630105115519776, 0.08833162940797,
        0.5864672203935648, -0.19889877699353958, -0.06271836934596224, 0.04156748868046687,
        -1.2148158666751574, 0.3898459780438331, 0.043286952334267256, -0.24834946301106395,
        -0.06452978654145826, -0.19671704552205846, 0.016934685803442553, 0.06609999311575206,
        -0.4835053905618841, 0.06367770747747095, -0.016872232888559265, 0.08557806557609757,
        -0.03572220698134279, -0.003901406462729308, -0.15437907136940163, 0.06058194487581814,
        -0.512192979931343, 0.06483209204105084, 0.03965225384251088, -0.25334242373295723,
        0.8223089440649015, -0.42954865913720985, 0.03278374301471495, 0.06619104741488703,
        -1.412595943219341, 0.7458503622447321, -0.025438907729066207, -0.29459434077958135,
        0.08630798722318488, 0.06412462348134386, 0.1337271988352911, -0.21561900607583168,
        -0.23815539352156187, 0.02788281741139957, 0.08592269043377894, 0.07350400687185331,
        -0.14639199469107816, 0.08850784781580076, 0.25305668939714693, -0.09009622557061162,
        0.06948950811697305, 0.020673457952657646, -0.010731244506549513, 0.07780540986539794,


        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,


        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,


        0.3786889454455295, 0.08032126547877537, 0.0048320479502505205, 0.08835848207898925,
        0.08032126547877881, 0.6129146247418328, -0.395307350448496, 0.9548535845771927,
        0.004832047950245586, -0.3953073504485007, 1.507228297804273, -1.6064934858736262,
        0.08835848207900088, 0.9548535845771919, -1.6064934858736002, 3.2376910703515325,
        -0.01275920481074565, 0.004341509801609747, -0.03831673509620798, -0.14525034032217446,
        0.11067211115661857, 0.10966443201099842, -0.1348652193832593, 0.32560773959590406,
        0.02506682338084525, 0.16217455364931904, -0.23175196220581837, 0.4360040650383404,
        0.027403160827504044, 0.01685774231136924, 0.11014382533047898, -0.07979480358721193,


        0.5420856563860538, -0.05887141608567703, 0.0019311519640299955, 0.01468042419765813,
        -0.05887141608567896, 0.2856556630829198, -0.024285518358815997, -0.08084672733107587,
        0.0019311519640275493, -0.024285518358816854, 0.4214640985177003, -0.06618450883126188,
        0.014680424197656186, -0.08084672733108086, -0.06618450883126693, 0.618811721564516
    };

    std::vector<conf::fp_type> reference_lower_column = {
        1.6657640408280994, 0., 0., 0.,
        -1.8673704908863058, 1.037699909127167, 0., 0.,
        0.1991461118312038, -0.07586948005704164, 0.5953893307710177, 0.,
        1.473522474945474, -0.5150608618535167, -0.11920226811930101, 0.8003267002247397,
        -2.669902907504787, 3.8208530659285262, -0.43040665729384114, -2.9448136398915463,
        0.40679131158035214, -0.48807673739537333, 0.1324094886862194, 0.4068694992940302,
        -1.2139940162825678, 1.7652970418405984, -0.2721964424785125, -1.2119409121257203,
        -0.7534909661420939, 1.0033410158599234, -0.03839094933425528, -0.6872580853867354,
        0.9769160068560081, -1.301548824046759, 0.09454116550037145, 1.0073613484996713,
        -2.0235965869348997, 2.673054437279339, -0.2457306785143098, -2.1947734970400403,
        -0.10749139798307422, -0.08363224109129343, 0.012156695122416124, 0.057118096653145975,
        -0.8054058931445324, 0.9689620497825184, -0.111164960585499, -0.67475233538174,
        -0.03572220698134279, -0.003901406462729308, -0.15437907136940163, 0.06058194487581814,
        -0.512192979931343, 0.06483209204105084, 0.03965225384251088, -0.25334242373295723,
        0.8223089440649015, -0.42954865913720985, 0.03278374301471495, 0.06619104741488703,
        -1.412595943219341, 0.7458503622447321, -0.025438907729066207, -0.29459434077958135,
        0.08630798722318488, 0.06412462348134386, 0.1337271988352911, -0.21561900607583168,
        -0.23815539352156187, 0.02788281741139957, 0.08592269043377894, 0.07350400687185331,
        -0.14639199469107816, 0.08850784781580076, 0.25305668939714693, -0.09009622557061162,
        0.06948950811697305, 0.020673457952657646, -0.010731244506549513, 0.07780540986539794,


        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,


        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,


        0.3786889454455295, 0.08032126547877537, 0.0048320479502505205, 0.08835848207898925,
        0.08032126547877881, 0.6129146247418328, -0.395307350448496, 0.9548535845771927,
        0.004832047950245586, -0.3953073504485007, 1.507228297804273, -1.6064934858736262,
        0.08835848207900088, 0.9548535845771919, -1.6064934858736002, 3.2376910703515325,
        -0.01275920481074565, 0.004341509801609747, -0.03831673509620798, -0.14525034032217446,
        0.11067211115661857, 0.10966443201099842, -0.1348652193832593, 0.32560773959590406,
        0.02506682338084525, 0.16217455364931904, -0.23175196220581837, 0.4360040650383404,
        0.027403160827504044, 0.01685774231136924, 0.11014382533047898, -0.07979480358721193,


        0.5420856563860538, -0.05887141608567703, 0.0019311519640299955, 0.01468042419765813,
        -0.05887141608567896, 0.2856556630829198, -0.024285518358815997, -0.08084672733107587,
        0.0019311519640275493, -0.024285518358816854, 0.4214640985177003, -0.06618450883126188,
        0.014680424197656186, -0.08084672733108086, -0.06618450883126693, 0.618811721564516
    };

    std::vector<conf::fp_type> reference_full_column_padding = {
        1.6657640408280994, 0., 0., 0., 0., 0.,
        -1.8673704908863058, 1.037699909127167, 0., 0., 0., 0.,
        0.1991461118312038, -0.07586948005704164, 0.5953893307710177, 0., 0., 0.,
        1.473522474945474, -0.5150608618535167, -0.11920226811930101, 0.8003267002247397, 0., 0.,
        -1.6028097870197155, 0.7977386909867202, -0.08513639374705588, -0.2277843149864492, 0.7476231523515432, 0.,
        0.24420704350066558, -0.0308872636623833, 0.13677303345588004, 0.05925051270406253, -0.20228166224240435,
        0.687247823984515,
        -0.7287911051790122, 0.3896830234369213, -0.16375079990680444, 0.053903197318863505, 0.07896304921863953,
        -0.08972044480560207,
        -0.45233955570772905, 0.15289148266779432, 0.10630105115519776, 0.08833162940797, 0.16095599153521986,
        0.07032002934530299,
        0.5864672203935648, -0.19889877699353958, -0.06271836934596224, 0.04156748868046687, -0.16793270463231466,
        -0.09887987445866923,
        -1.2148158666751574, 0.3898459780438331, 0.043286952334267256, -0.24834946301106395, 0.376960894797878,
        0.042638723636111736,
        -0.06452978654145826, -0.19671704552205846, 0.016934685803442553, 0.06609999311575206, 0.08705939366407353,
        0.20435207173428632,
        -0.4835053905618841, 0.06367770747747095, -0.016872232888559265, 0.08557806557609757, 0.25377564895021976,
        -0.009468973535148594,
        -0.03572220698134279, -0.003901406462729308, -0.15437907136940163, 0.06058194487581814, -0.06553780909059,
        -0.09862278024942864,
        -0.512192979931343, 0.06483209204105084, 0.03965225384251088, -0.25334242373295723, 0.09544310137620812,
        -0.040037652557488125,
        0.8223089440649015, -0.42954865913720985, 0.03278374301471495, 0.06619104741488703, -0.33677294498729193,
        -0.007508548512570383,
        -1.412595943219341, 0.7458503622447321, -0.025438907729066207, -0.29459434077958135, 0.11017987748351239,
        -0.22311495828024608,
        0.08630798722318488, 0.06412462348134386, 0.1337271988352911, -0.21561900607583168, 0.05072306497208548,
        0.04958137496388763,
        -0.23815539352156187, 0.02788281741139957, 0.08592269043377894, 0.07350400687185331, -0.061265894457521716,
        0.04158721583132513,
        -0.14639199469107816, 0.08850784781580076, 0.25305668939714693, -0.09009622557061162, 0.1006642387148391,
        -0.048148510567584145,
        0.06948950811697305, 0.020673457952657646, -0.010731244506549513, 0.07780540986539794, -0.14578149706600874,
        -0.07726841256168698,
        0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0.,


        1.2025252268184892e+00, 4.1705809958244894e-01, -5.6172013402170251e-01, 1.1991260426896690e+00,
        -1.1699354606422368e-02, 4.2401421263562933e-01,
        4.1705809958245399e-01, 6.4400883451936553e-01, -3.0917013285923317e-01, 6.3979373238595694e-01,
        -2.7705208888286797e-02, 1.8968539503475218e-01,
        -5.6172013402169785e-01, -3.0917013285922595e-01, 8.7437568791152032e-01, -9.1868391894345802e-01,
        1.9199872942222414e-02, -3.0485646763521551e-01,
        1.1991260426896397e+00, 6.3979373238592463e-01, -9.1868391894344226e-01, 2.3375001311373147e+00,
        1.7705425733133173e-02, 7.1228259711908515e-01,
        -1.1699354606433503e-02, -2.7705208888295679e-02, 1.9199872942229981e-02, 1.7705425733118188e-02,
        4.1648904069244608e-01, 1.5919695681616410e-02,
        4.2401421263563355e-01, 1.8968539503475143e-01, -3.0485646763521962e-01, 7.1228259711910491e-01,
        1.5919695681622468e-02, 7.9464265632871822e-01,
        -1.2808413323261096e-02, 2.5652730179867012e-02, 1.8059926955854736e-02, -9.0031534990619132e-04,
        -5.8949311819491042e-02, 2.4649625448028437e-03,
        4.4057696635745036e-01, 2.9339009605742905e-01, -3.5076249947980853e-01, 6.8780733199268662e-01,
        -9.8735878836572373e-03, 3.1680270348929285e-01,
        -7.1324932560104082e-01, -5.8240859554991919e-01, 6.3142354939312706e-01, -1.2381324707014414e+00,
        1.0006225971922125e-01, -5.5001733936741626e-01,
        1.2307058485183657e+00, 7.7925883154646780e-01, -1.1064181741274410e+00, 2.2420636674640244e+00,
        -9.3452790738735789e-02, 8.2771855573717035e-01,
        -4.4341279224073042e-02, -3.4565675343943537e-02, 7.2517465362718969e-02, -9.1395038026401379e-02,
        5.1051443038971196e-02, -1.1279189261063732e-01,
        1.7864711950652662e-01, 1.5436479167763201e-01, -1.0855336182283683e-01, 2.7696135750196627e-01,
        5.0026860615359554e-02, 7.4913663046502502e-02,
        1.1086531578325651e-02, 2.4380787948738807e-02, -9.1788861387306867e-02, 3.7404010142305244e-01,
        2.4631811701543577e-02, 1.7866073490049519e-01,
        -2.1049381211188517e-02, -6.4323645432827578e-02, 8.3036032711741647e-02, -2.0358580926964912e-01,
        -1.3026138476656304e-01, -6.2021809656662992e-02,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,


        3.7868894544552950e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        -1.2759204810744412e-02, 1.1067211115661844e-01,
        8.0321265478778811e-02, 6.1291462474183278e-01, -3.9530735044849602e-01, 9.5485358457719272e-01,
        4.3415098016043397e-03, 1.0966443201100005e-01,
        4.8320479502455861e-03, -3.9530735044850068e-01, 1.5072282978042730e+00, -1.6064934858736262e+00,
        -3.8316735096194848e-02, -1.3486521938326285e-01,
        8.8358482079000877e-02, 9.5485358457719194e-01, -1.6064934858736002e+00, 3.2376910703515325e+00,
        -1.4525034032219516e-01, 3.2560773959590766e-01,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        5.4208565638605377e-01, -5.8871416085677031e-02,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        -5.8871416085678960e-02, 2.8565566308291979e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        1.9311519640275493e-03, -2.4285518358816854e-02,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,
        1.4680424197656186e-02, -8.0846727331080864e-02,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,


        0.4214640985177003, -0.06618450883126188, 0., 0., 0., 0.,
        -0.06618450883126693, 0.618811721564516, 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0.
    };

    std::vector<conf::fp_type> reference_mid_column = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,


        1.9553671036635423, 0., 0., 0.,
        -0.30297561916736243, 0.7100998561677488, 0., 0.,
        0.7874102983945959, -0.06799311275530182, 0.760188914295958, 0.,
        0.4797797274851628, 0.09254516463312716, 0.05994172521674267, 0.6337685931747458,
        -0.6281909072094155, -0.1141589058579526, -0.09844679694453637, 0.01371013819842059,
        1.3260034321229353, 0.05252161683245671, 0.20861708157335632, -0.02171348111338196,
        -0.002511296398244514, 0.16704583847352192, 0.0021521394744552294, -0.06641008692414539,
        0.5101021654115013, -0.02897134294367895, 0.02681525892635619, -0.08516906428795071,
        0.002296078947246422, -0.1125954764065232, -0.02929809424532677, 0.05795090457213728,
        0.5105711558290112, -0.04056119034952519, 0.04708053213151245, 0.07788341092017306,
        -0.9871906036187409, -0.01921549839022122, 0.0825692133068919, -0.17663481215187618,
        1.5397410865779075, -0.13808763159046733, 0.011719260848527244, 0.08299423966835895,
        -0.005896222519032771, 0.06567957492602822, -0.04634739271346161, -0.05528354052869557,
        0.17086253941784657, 0.07016968447850432, 0.06429882192255017, 0.09789118998430564,
        0.19407186728902073, -0.0054416043360820746, -0.18692412412053389, -0.08997418239442048,
        -0.11286131434246634, -0.05398438650328688, 0.08438456850332485, -0.016152958012474065,


        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,


        0.3786889454455295, 0.08032126547877537, 0.0048320479502505205, 0.08835848207898925,
        0.08032126547877881, 0.6129146247418328, -0.395307350448496, 0.9548535845771927,
        0.004832047950245586, -0.3953073504485007, 1.507228297804273, -1.6064934858736262,
        0.08835848207900088, 0.9548535845771919, -1.6064934858736002, 3.2376910703515325,
        -0.01275920481074565, 0.004341509801609747, -0.03831673509620798, -0.14525034032217446,
        0.11067211115661857, 0.10966443201099842, -0.1348652193832593, 0.32560773959590406,
        0.02506682338084525, 0.16217455364931904, -0.23175196220581837, 0.4360040650383404,
        0.027403160827504044, 0.01685774231136924, 0.11014382533047898, -0.07979480358721193,


        0.5420856563860538, -0.05887141608567703, 0.0019311519640299955, 0.01468042419765813,
        -0.05887141608567896, 0.2856556630829198, -0.024285518358815997, -0.08084672733107587,
        0.0019311519640275493, -0.024285518358816854, 0.4214640985177003, -0.06618450883126188,
        0.014680424197656186, -0.08084672733108086, -0.06618450883126693, 0.618811721564516

    };

    std::vector<conf::fp_type> reference_mid_column_lower = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,


        1.9553671036635423e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        -3.0297561916736243e-01, 7.1009985616774884e-01, 0.0000000000000000e+00, 0.0000000000000000e+00,
        7.8741029839459586e-01, -6.7993112755301816e-02, 7.6018891429595803e-01, 0.0000000000000000e+00,
        4.7977972748516279e-01, 9.2545164633127161e-02, 5.9941725216742667e-02, 6.3376859317474576e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        2.2960789472464219e-03, -1.1259547640652320e-01, -2.9298094245326770e-02, 5.7950904572137280e-02,
        5.1057115582901125e-01, -4.0561190349525190e-02, 4.7080532131512448e-02, 7.7883410920173063e-02,
        -9.8719060361874089e-01, -1.9215498390221221e-02, 8.2569213306891903e-02, -1.7663481215187618e-01,
        1.5397410865779075e+00, -1.3808763159046733e-01, 1.1719260848527244e-02, 8.2994239668358949e-02,
        -5.8962225190327712e-03, 6.5679574926028217e-02, -4.6347392713461610e-02, -5.5283540528695573e-02,
        1.7086253941784657e-01, 7.0169684478504316e-02, 6.4298821922550167e-02, 9.7891189984305640e-02,
        1.9407186728902073e-01, -5.4416043360820746e-03, -1.8692412412053389e-01, -8.9974182394420482e-02,
        -1.1286131434246634e-01, -5.3984386503286880e-02, 8.4384568503324847e-02, -1.6152958012474065e-02,


        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,


        0.3786889454455295, 0.08032126547877537, 0.0048320479502505205, 0.08835848207898925,
        0.08032126547877881, 0.6129146247418328, -0.395307350448496, 0.9548535845771927,
        0.004832047950245586, -0.3953073504485007, 1.507228297804273, -1.6064934858736262,
        0.08835848207900088, 0.9548535845771919, -1.6064934858736002, 3.2376910703515325,
        -0.01275920481074565, 0.004341509801609747, -0.03831673509620798, -0.14525034032217446,
        0.11067211115661857, 0.10966443201099842, -0.1348652193832593, 0.32560773959590406,
        0.02506682338084525, 0.16217455364931904, -0.23175196220581837, 0.4360040650383404,
        0.027403160827504044, 0.01685774231136924, 0.11014382533047898, -0.07979480358721193,


        0.5420856563860538, -0.05887141608567703, 0.0019311519640299955, 0.01468042419765813,
        -0.05887141608567896, 0.2856556630829198, -0.024285518358815997, -0.08084672733107587,
        0.0019311519640275493, -0.024285518358816854, 0.4214640985177003, -0.06618450883126188,
        0.014680424197656186, -0.08084672733108086, -0.06618450883126693, 0.618811721564516

    };
};

class SYRKTest : public ::testing::Test {
public:
    std::string path_A = "../tests/testData/testMatrixSymmetric20x20.txt";

    std::vector<conf::fp_type> reference_syrk_full = {

        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,


        -2.6761016441162539e+01, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        3.6136790216859449e+00, 9.2628966256078638e-03, -2.8684802228278411e-01, -7.9645251903748354e-02,
        -1.2132605863495639e+01, 1.5977378004280804e+00, -4.9304215684646389e+00, 4.1705809958244894e-01,
        -6.9475915259183525e+00, 1.0012834150516008e+00, -3.1122364225934165e+00, -1.4042305365654300e+00,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,


        -2.7977334563427139e+00, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        6.7714724920818767e+00, -1.3780077309848497e+01, 1.7705425733133173e-02, 7.1228259711908515e-01,
        -4.3329375807296774e-02, 1.5208829047502470e-01, 3.9453002610056070e-01, 1.5919695681616410e-02,
        2.4333379452442161e+00, -5.0158675100252754e+00, 5.0273925682839143e-02, -1.2605718128670511e+00,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,


        3.6120939053841011e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        -2.6630222265130274e-02, -2.1612143244654631e+00, -3.9530735044849602e-01, 9.5485358457719272e-01,
        2.0770104730869965e-01, 4.2951574536390922e+00, -6.5375169229229613e+00, -1.6064934858736262e+00,
        -2.5641938975454004e-01, -7.2614641873315549e+00, 1.2451689881932804e+01, -2.1345547755011765e+01,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,

        4.9510517989510350e-01, -5.8871416085677031e-02, 1.9311519640299955e-03, 1.4680424197658130e-02,
        1.2952186867610641e-02, -1.9637973981109119e-01, -2.4285518358815997e-02, -8.0846727331075868e-02,
        2.6688254606924127e-02, -4.0934055847789486e-01, 8.3256737128770519e-02, -6.6184508831261882e-02,
        1.9023033689042762e-03, 6.5548681403913511e-02, 5.7384121131461727e-02, 5.6953073798942577e-01
    };


    std::vector<conf::fp_type> reference_syrk_lower = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,


        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,

        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,

        3.6120939053841011e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        -2.6630222265130274e-02, -2.1612143244654631e+00, -3.9530735044849602e-01, 9.5485358457719272e-01,
        2.0770104730869965e-01, 4.2951574536390922e+00, -6.5375169229229613e+00, -1.6064934858736262e+00,
        -2.5641938975454004e-01, -7.2614641873315549e+00, 1.2451689881932804e+01, -2.1345547755011765e+01,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,

        4.9510517989510350e-01, -5.8871416085677031e-02, 1.9311519640299955e-03, 1.4680424197658130e-02,
        1.2952186867610641e-02, -1.9637973981109119e-01, -2.4285518358815997e-02, -8.0846727331075868e-02,
        2.6688254606924127e-02, -4.0934055847789486e-01, 8.3256737128770519e-02, -6.6184508831261882e-02,
        1.9023033689042762e-03, 6.5548681403913511e-02, 5.7384121131461727e-02, 5.6953073798942577e-01
    };

    std::vector<conf::fp_type> reference_syrk_lower2 = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,


        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,


        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,


        3.7488087651181057e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        8.5912306087883986e-02, -8.3660072918208872e-02, -3.9530735044849602e-01, 9.5485358457719272e-01,
        -4.3175140850654214e-04, 8.5300389688647682e-01, -7.3697094535412577e-01, -1.6064934858736262e+00,
        1.0280960488246765e-01, -1.2384904394539249e+00, 2.3327074880041634e+00, -3.7071710262586839e+00,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,


        5.1314555975252241e-01, -5.8871416085677031e-02, 1.9311519640299955e-03, 1.4680424197658130e-02,
        -1.9790797216661736e-02, 1.8904949347647457e-01, -2.4285518358815997e-02, -8.0846727331075868e-02,
        6.1666849725930069e-02, -1.5246054439527423e-01, 2.4060652162746937e-01, -6.6184508831261882e-02,
        -1.0293396837934432e-02, -4.2846356348977127e-03, 3.1875966807647094e-02, 5.4965482386564268e-01


    };

    std::vector<conf::fp_type> reference_syrk_padding = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -2.6699029075047620e+00, 4.0679131158037513e-01, -1.2139940162825444e+00, -7.5349096614206290e-01,
        9.7691600685599578e-01,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.8208530659285511e+00, -4.8807673739540747e-01, 1.7652970418405887e+00, 1.0033410158599028e+00,
        -1.3015488240467616e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        -4.3040665729383115e-01, 1.3240948868622146e-01, -2.7219644247850666e-01, -3.8390949334249039e-02,
        9.4541165500368077e-02,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.9448136398915512e+00, 4.0686949929405408e-01, -1.2119409121257083e+00, -6.8725808538671529e-01,
        1.0073613484996695e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -1.2283438347778430e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.0926230643706929e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        -5.6172013402170251e-01,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -3.0917013285923317e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        8.7437568791152032e-01,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -9.1868391894344226e-01,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        1.9199872942229981e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        -3.0485646763521962e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        1.8059926955854736e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -3.5076249947980853e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        6.3142354939312706e-01,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1064181741274410e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        7.2517465362718969e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        -1.0855336182283683e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -9.1788861387306867e-02,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,
        8.3036032711741647e-02,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,

        -2.3326855009648551e+01, 1.7705425733133173e-02, 7.1228259711908515e-01, -9.0031534989483994e-04,
        6.8780733199268096e-01, -1.2381324707014076e+00, 2.2420636674640124e+00, -9.1395038026422237e-02,
        2.7696135750196771e-01,
        2.5772180741432865e-01, 3.7898121912837679e-01, 1.5919695681616410e-02, -5.8949311819489487e-02,
        -9.8735878836622871e-03, 1.0006225971923594e-01, -9.3452790738751790e-02, 5.1051443038968421e-02,
        5.0026860615357348e-02,
        -8.5757413921453640e+00, 9.2146986115219667e-02, -2.5948258245484315e+00, 2.4649625448049024e-03,
        3.1680270348929673e-01, -5.5001733936742370e-01, 8.2771855573718722e-01, -1.1279189261064142e-01,
        7.4913663046505957e-02,
        -3.0287406692144825e-01, -4.9969642793138730e-02, -1.1870926324660176e-01, 3.5353658225685164e-01,
        8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02, -1.2759204810744412e-02,
        1.1067211115661844e-01,
        -9.6744804301165814e+00, 8.8737524408881704e-02, -3.4206904265879965e+00, -4.1459591438957666e-02,
        -3.5948149813080854e+00, -3.9530735044849602e-01, 9.5485358457719272e-01, 4.3415098016043397e-03,
        1.0966443201100005e-01,
        1.7052541827858718e+01, -8.5832105976901579e-02, 6.0777455741863680e+00, 2.3379031052412780e-01,
        6.9812721638169570e+00, -1.1591753984237300e+01, -1.6064934858736262e+00, -3.8316735096194848e-02,
        -1.3486521938326285e-01,
        -2.8651528576111474e+01, 2.3678303812599422e-01, -1.0342205669914298e+01, -2.9971321109604471e-01,
        -1.1529798022438870e+01, 2.0454837593044612e+01, -3.4074988325967070e+01, -1.4525034032219516e-01,
        3.2560773959590766e-01,
        4.5742573218429450e-01, 5.4156904281077209e-02, 1.0868835859945525e-01, 1.5303266084480672e-02,
        2.1310290180017957e-01, -4.3636596666930194e-01, 5.1753253328712379e-01, 4.8420751188283595e-01,
        -5.8871416085677031e-02,
        -3.7663065625174297e+00, 7.5390000169819074e-02, -1.3887787290914149e+00, 6.1328619224362196e-02,
        -1.5248597941375970e+00, 2.7473413639507682e+00, -4.5451687922912800e+00, 3.8027218165876980e-02,
        -3.7553275116565277e-01,
        3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01, 2.5066823380845250e-02,
        1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01, 1.9311519640275493e-03,
        -2.4285518358816854e-02,
        -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02, 2.7403160827504044e-02,
        1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02, 1.4680424197656186e-02,
        -8.0846727331080864e-02,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,

        -0.07381885420740736, -0.06618450883126188, 0., 0., 0., 0., 0., 0., 0.,
        0.1502941428124802, 0.5093360049716221, 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.
    };
};

class GEMMTest : public ::testing::Test {
public:
    std::string path_A = "../tests/testData/testMatrixSymmetric20x20.txt";

    std::vector<conf::fp_type> reference_gemm_full_lower_triangle = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,

        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        9.3601364535107550e+00, -1.3457770957531665e+00, 4.1684665420708695e+00, 2.4287713290539581e+00,
        -1.9592294213118596e+01, 2.6889095473303151e+00, -8.7030660064387479e+00, -5.0847628349962273e+00,
        2.0107887503290947e-01, 9.7438429679711544e-02, 7.7975246562542677e-02, 1.4934232341946043e-02,
        -6.8900461806294429e+00, 9.1469433011833490e-01, -3.1122682300585711e+00, -1.8573767633800293e+00,
        -3.8840358851705648e-01, -1.9404000417838123e-02, -2.0282618763916804e-01, -7.4666909014500460e-02,
        -8.1588357235518281e+00, 1.0793492041567168e+00, -3.6316718243177464e+00, -2.0640685578010878e+00,
        1.3754216646468496e+01, -1.8703513670895202e+00, 6.3020823211548995e+00, 3.4644248923159080e+00,
        -2.4405888099693254e+01, 3.2025045090460313e+00, -1.1015127300730189e+01, -6.2849957906475620e+00,
        4.9558193755123864e-01, -3.0026434870984768e-02, 2.0790829986611625e-01, 1.0738756201752914e-01,
        -3.4667973838688333e+00, 5.1926368701616754e-01, -1.5224916607741639e+00, -8.3738914007838794e-01,
        -2.6882463434355719e+00, 3.4751174593197398e-01, -1.3390379889465582e+00, -7.7125355120785399e-01,
        9.6204673531765905e-01, -1.6805449798988645e-01, 5.0048254900332645e-01, 2.3852061470751723e-01,

        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.5069869682653522e-01, -2.7737806795608994e-01, -5.9833771909647178e-02, -1.0617832040278682e-01,
        2.8259790756246819e+00, -5.9807940230386425e+00, 4.1912181829126066e-02, -2.0433667351478899e+00,
        -4.7988044091059976e+00, 1.0135554350195827e+01, -5.6726791563248696e-03, 3.4969888900243342e+00,
        8.3845820400871780e+00, -1.7648622274394697e+01, 9.7370381217044430e-02, -6.2333473166143900e+00,
        -1.0473421279592421e-01, 2.6797731483919091e-01, 6.2863295257685178e-02, 4.1242954316368763e-02,
        1.2143715152605905e+00, -2.4866316624767939e+00, 6.5066867752172478e-02, -9.1707349694496254e-01,
        9.7717197512981790e-01, -1.8654010211926315e+00, 4.8333964889234381e-02, -6.0417657199382613e-01,
        -3.2800991399280577e-01, 6.6245272111020870e-01, -1.3581876933049419e-01, 2.4159407349968159e-01,

        0.3786889454455295, 0.08032126547877537, 0.0048320479502505205, 0.08835848207898925,
        0.08032126547877881, 0.6129146247418328, -0.395307350448496, 0.9548535845771927,
        0.004832047950245586, -0.3953073504485007, 1.507228297804273, -1.6064934858736262,
        0.08835848207900088, 0.9548535845771919, -1.6064934858736002, 3.2376910703515325,
        0.012336902062806906, 0.13759347878282435, -0.30274075969157205, 0.2937402460342824,
        0.06269627853470905, -1.0288814408829914, 1.816003238173348, -3.077924559887573,
        0.004918812416309454, -0.7721673581690573, 1.3398983794048809, -2.324358666169224,
        0.03913309622840852, 0.3815999048437251, -0.4944227770700902, 0.9832337713535865,

        0.5420856563860538, -0.05887141608567703, 0.0019311519640299955, 0.01468042419765813,
        -0.05887141608567896, 0.2856556630829198, -0.024285518358815997, -0.08084672733107587,
        0.0019311519640275493, -0.024285518358816854, 0.4214640985177003, -0.06618450883126188,
        0.014680424197656186, -0.08084672733108086, -0.06618450883126693, 0.618811721564516

    };

    std::vector<conf::fp_type> reference_gemm_upper_lower_triangle = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,

        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        9.3601364535107550e+00, -1.3457770957531665e+00, 4.1684665420708695e+00, 2.4287713290539581e+00,
        -1.9592294213118596e+01, 2.6889095473303151e+00, -8.7030660064387479e+00, -5.0847628349962273e+00,
        2.0107887503290947e-01, 9.7438429679711544e-02, 7.7975246562542677e-02, 1.4934232341946043e-02,
        -6.8900461806294429e+00, 9.1469433011833490e-01, -3.1122682300585711e+00, -1.8573767633800293e+00,
        -3.8840358851705648e-01, -1.9404000417838123e-02, -2.0282618763916804e-01, -7.4666909014500460e-02,
        -8.1588357235518281e+00, 1.0793492041567168e+00, -3.6316718243177464e+00, -2.0640685578010878e+00,
        1.3754216646468496e+01, -1.8703513670895202e+00, 6.3020823211548995e+00, 3.4644248923159080e+00,
        -2.4405888099693254e+01, 3.2025045090460313e+00, -1.1015127300730189e+01, -6.2849957906475620e+00,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,

        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.5069869682653522e-01, -2.7737806795608994e-01, -5.9833771909647178e-02, -1.0617832040278682e-01,
        2.8259790756246819e+00, -5.9807940230386425e+00, 4.1912181829126066e-02, -2.0433667351478899e+00,
        -4.7988044091059976e+00, 1.0135554350195827e+01, -5.6726791563248696e-03, 3.4969888900243342e+00,
        8.3845820400871780e+00, -1.7648622274394697e+01, 9.7370381217044430e-02, -6.2333473166143900e+00,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,

        0.3786889454455295, 0.08032126547877537, 0.0048320479502505205, 0.08835848207898925,
        0.08032126547877881, 0.6129146247418328, -0.395307350448496, 0.9548535845771927,
        0.004832047950245586, -0.3953073504485007, 1.507228297804273, -1.6064934858736262,
        0.08835848207900088, 0.9548535845771919, -1.6064934858736002, 3.2376910703515325,
        -0.01275920481074565, 0.004341509801609747, -0.03831673509620798, -0.14525034032217446,
        0.11067211115661857, 0.10966443201099842, -0.1348652193832593, 0.32560773959590406,
        0.02506682338084525, 0.16217455364931904, -0.23175196220581837, 0.4360040650383404,
        0.027403160827504044, 0.01685774231136924, 0.11014382533047898, -0.07979480358721193,

        0.5420856563860538, -0.05887141608567703, 0.0019311519640299955, 0.01468042419765813,
        -0.05887141608567896, 0.2856556630829198, -0.024285518358815997, -0.08084672733107587,
        0.0019311519640275493, -0.024285518358816854, 0.4214640985177003, -0.06618450883126188,
        0.014680424197656186, -0.08084672733108086, -0.06618450883126693, 0.618811721564516

    };

    std::vector<conf::fp_type> reference_gemm_lower_lower_triangle = {

        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,

        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        -3.8840358851705648e-01, -1.9404000417838123e-02, -2.0282618763916804e-01, -7.4666909014500460e-02,
        -8.1588357235518281e+00, 1.0793492041567168e+00, -3.6316718243177464e+00, -2.0640685578010878e+00,
        1.3754216646468496e+01, -1.8703513670895202e+00, 6.3020823211548995e+00, 3.4644248923159080e+00,
        -2.4405888099693254e+01, 3.2025045090460313e+00, -1.1015127300730189e+01, -6.2849957906475620e+00,
        4.9558193755123864e-01, -3.0026434870984768e-02, 2.0790829986611625e-01, 1.0738756201752914e-01,
        -3.4667973838688333e+00, 5.1926368701616754e-01, -1.5224916607741639e+00, -8.3738914007838794e-01,
        -2.6882463434355719e+00, 3.4751174593197398e-01, -1.3390379889465582e+00, -7.7125355120785399e-01,
        9.6204673531765905e-01, -1.6805449798988645e-01, 5.0048254900332645e-01, 2.3852061470751723e-01,

        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.5069869682653522e-01, -2.7737806795608994e-01, -5.9833771909647178e-02, -1.0617832040278682e-01,
        2.8259790756246819e+00, -5.9807940230386425e+00, 4.1912181829126066e-02, -2.0433667351478899e+00,
        -4.7988044091059976e+00, 1.0135554350195827e+01, -5.6726791563248696e-03, 3.4969888900243342e+00,
        8.3845820400871780e+00, -1.7648622274394697e+01, 9.7370381217044430e-02, -6.2333473166143900e+00,
        -1.0473421279592421e-01, 2.6797731483919091e-01, 6.2863295257685178e-02, 4.1242954316368763e-02,
        1.2143715152605905e+00, -2.4866316624767939e+00, 6.5066867752172478e-02, -9.1707349694496254e-01,
        9.7717197512981790e-01, -1.8654010211926315e+00, 4.8333964889234381e-02, -6.0417657199382613e-01,
        -3.2800991399280577e-01, 6.6245272111020870e-01, -1.3581876933049419e-01, 2.4159407349968159e-01,

        0.3786889454455295, 0.08032126547877537, 0.0048320479502505205, 0.08835848207898925,
        0.08032126547877881, 0.6129146247418328, -0.395307350448496, 0.9548535845771927,
        0.004832047950245586, -0.3953073504485007, 1.507228297804273, -1.6064934858736262,
        0.08835848207900088, 0.9548535845771919, -1.6064934858736002, 3.2376910703515325,
        0.012336902062806906, 0.13759347878282435, -0.30274075969157205, 0.2937402460342824,
        0.06269627853470905, -1.0288814408829914, 1.816003238173348, -3.077924559887573,
        0.004918812416309454, -0.7721673581690573, 1.3398983794048809, -2.324358666169224,
        0.03913309622840852, 0.3815999048437251, -0.4944227770700902, 0.9832337713535865,

        0.5420856563860538, -0.05887141608567703, 0.0019311519640299955, 0.01468042419765813,
        -0.05887141608567896, 0.2856556630829198, -0.024285518358815997, -0.08084672733107587,
        0.0019311519640275493, -0.024285518358816854, 0.4214640985177003, -0.06618450883126188,
        0.014680424197656186, -0.08084672733108086, -0.06618450883126693, 0.618811721564516

    };

    std::vector<conf::fp_type> reference_gemm_full_lower_triangle2 = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,
        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,

        0.8743756879115203, -0.918683918943458, 0.019199872942222414, -0.3048564676352155,
        -0.9186839189434423, 2.3375001311373147, 0.017705425733133173, 0.7122825971190851,
        0.01919987294222998, 0.017705425733118188, 0.4164890406924461, 0.01591969568161641,
        -0.3048564676352196, 0.7122825971191049, 0.015919695681622468, 0.7946426563287182,
        0.03312307953845228, -0.04298767878690152, -0.048738434400084234, -0.015571665836524064,
        1.2337968208743129, -2.6836392074447444, 0.03021715927318708, -0.9535887713804989,
        -2.3515719092483325, 5.098776346091793, 0.032026084819724465, 1.8382457919449355,
        3.5857501062657375, -7.744394050055102, 0.024716777805993087, -2.9438410612708377,
        0.017470403796524155, 0.03143275004743423, 0.043737378183419995, -0.06745390665988873,
        0.4501216745558141, -0.9029873146847804, 0.05826578227855577, -0.3636983746647121,
        0.39495725774306395, -0.6616195519775555, 0.03478116884815932, -0.22014755593364407,
        -0.21929985333108865, 0.4334980942070159, -0.13287918261839918, 0.17849935181426,

        3.7868894544552950e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        8.0321265478778811e-02, 6.1291462474183278e-01, -3.9530735044849602e-01, 9.5485358457719272e-01,
        4.8320479502455861e-03, -3.9530735044850068e-01, 1.5072282978042730e+00, -1.6064934858736262e+00,
        8.8358482079000877e-02, 9.5485358457719194e-01, -1.6064934858736002e+00, 3.2376910703515325e+00,
        -8.4831806615974538e-03, 5.4414525412397191e-02, -1.2615270670161674e-01, -1.6926946883026039e-03,
        1.0734398606093881e-01, -3.4823747272369260e-01, 7.2792975737342891e-01, -1.0215310804243845e+00,
        1.7825878349149102e-02, -2.4021838444721039e-01, 5.4076346798702091e-01, -7.7454433968509018e-01,
        2.9440538510760547e-02, 2.6456592211809249e-01, -3.6714374900563396e-01, 6.5832851134956727e-01,

        0.5420856563860538, -0.05887141608567703, 0.0019311519640299955, 0.01468042419765813,
        -0.05887141608567896, 0.2856556630829198, -0.024285518358815997, -0.08084672733107587,
        0.0019311519640275493, -0.024285518358816854, 0.4214640985177003, -0.06618450883126188,
        0.014680424197656186, -0.08084672733108086, -0.06618450883126693, 0.618811721564516
    };


    std::vector<conf::fp_type> reference_gemm_upper_lower_triangle2 = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,
        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,

        0.8743756879115203, -0.918683918943458, 0.019199872942222414, -0.3048564676352155,
        -0.9186839189434423, 2.3375001311373147, 0.017705425733133173, 0.7122825971190851,
        0.01919987294222998, 0.017705425733118188, 0.4164890406924461, 0.01591969568161641,
        -0.3048564676352196, 0.7122825971191049, 0.015919695681622468, 0.7946426563287182,
        0.03312307953845228, -0.04298767878690152, -0.048738434400084234, -0.015571665836524064,
        1.2337968208743129, -2.6836392074447444, 0.03021715927318708, -0.9535887713804989,
        -2.3515719092483325, 5.098776346091793, 0.032026084819724465, 1.8382457919449355,
        3.5857501062657375, -7.744394050055102, 0.024716777805993087, -2.9438410612708377,
        0.07251746536271897, -0.09139503802640138, 0.051051443038971196, -0.11279189261063732,
        -0.10855336182283683, 0.27696135750196627, 0.050026860615359554, 0.0749136630465025,
        -0.09178886138730687, 0.37404010142305244, 0.024631811701543577, 0.1786607349004952,
        0.08303603271174165, -0.20358580926964912, -0.13026138476656304, -0.06202180965666299,

        0.3786889454455295, 0.08032126547877537, 0.0048320479502505205, 0.08835848207898925,
        0.08032126547877881, 0.6129146247418328, -0.395307350448496, 0.9548535845771927,
        0.004832047950245586, -0.3953073504485007, 1.507228297804273, -1.6064934858736262,
        0.08835848207900088, 0.9548535845771919, -1.6064934858736002, 3.2376910703515325,
        -0.01275920481074565, 0.004341509801609747, -0.03831673509620798, -0.14525034032217446,
        0.11067211115661857, 0.10966443201099842, -0.1348652193832593, 0.32560773959590406,
        0.02506682338084525, 0.16217455364931904, -0.23175196220581837, 0.4360040650383404,
        0.027403160827504044, 0.01685774231136924, 0.11014382533047898, -0.07979480358721193,

        0.5420856563860538, -0.05887141608567703, 0.0019311519640299955, 0.01468042419765813,
        -0.05887141608567896, 0.2856556630829198, -0.024285518358815997, -0.08084672733107587,
        0.0019311519640275493, -0.024285518358816854, 0.4214640985177003, -0.06618450883126188,
        0.014680424197656186, -0.08084672733108086, -0.06618450883126693, 0.618811721564516


    };


    std::vector<conf::fp_type> reference_gemm_lower_lower_triangle2 = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,
        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,

        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        1.7470403796524155e-02, 3.1432750047434233e-02, 4.3737378183419995e-02, -6.7453906659888735e-02,
        4.5012167455581409e-01, -9.0298731468478044e-01, 5.8265782278555771e-02, -3.6369837466471211e-01,
        3.9495725774306395e-01, -6.6161955197755551e-01, 3.4781168848159322e-02, -2.2014755593364407e-01,
        -2.1929985333108865e-01, 4.3349809420701590e-01, -1.3287918261839918e-01, 1.7849935181425999e-01,

        3.7868894544552950e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        8.0321265478778811e-02, 6.1291462474183278e-01, -3.9530735044849602e-01, 9.5485358457719272e-01,
        4.8320479502455861e-03, -3.9530735044850068e-01, 1.5072282978042730e+00, -1.6064934858736262e+00,
        8.8358482079000877e-02, 9.5485358457719194e-01, -1.6064934858736002e+00, 3.2376910703515325e+00,
        -8.4831806615974538e-03, 5.4414525412397191e-02, -1.2615270670161674e-01, -1.6926946883026039e-03,
        1.0734398606093881e-01, -3.4823747272369260e-01, 7.2792975737342891e-01, -1.0215310804243845e+00,
        1.7825878349149102e-02, -2.4021838444721039e-01, 5.4076346798702091e-01, -7.7454433968509018e-01,
        2.9440538510760547e-02, 2.6456592211809249e-01, -3.6714374900563396e-01, 6.5832851134956727e-01,


        0.5420856563860538, -0.05887141608567703, 0.0019311519640299955, 0.01468042419765813,
        -0.05887141608567896, 0.2856556630829198, -0.024285518358815997, -0.08084672733107587,
        0.0019311519640275493, -0.024285518358816854, 0.4214640985177003, -0.06618450883126188,
        0.014680424197656186, -0.08084672733108086, -0.06618450883126693, 0.618811721564516

    };


    std::vector<conf::fp_type> reference_gemm_full_lower_triangle_padding = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -2.6699029075047620e+00, 4.0679131158037513e-01, -1.2139940162825444e+00, -7.5349096614206290e-01,
        9.7691600685599578e-01,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.8208530659285511e+00, -4.8807673739540747e-01, 1.7652970418405887e+00, 1.0033410158599028e+00,
        -1.3015488240467616e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        -4.3040665729383115e-01, 1.3240948868622146e-01, -2.7219644247850666e-01, -3.8390949334249039e-02,
        9.4541165500368077e-02,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.9448136398915512e+00, 4.0686949929405408e-01, -1.2119409121257083e+00, -6.8725808538671529e-01,
        1.0073613484996695e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -1.2283438347778430e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.0926230643706929e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        -5.6172013402170251e-01,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -3.0917013285923317e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        8.7437568791152032e-01,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -9.1868391894344226e-01,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        1.9199872942229981e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        -3.0485646763521962e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        1.8059926955854736e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -3.5076249947980853e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        6.3142354939312706e-01,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1064181741274410e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        7.2517465362718969e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        -1.0855336182283683e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -9.1788861387306867e-02,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,
        8.3036032711741647e-02,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,


        2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01, -9.0031534989483994e-04,
        6.8780733199268096e-01, -1.2381324707014076e+00, 2.2420636674640124e+00, -9.1395038026422237e-02,
        2.7696135750196771e-01,
        1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02, -5.8949311819489487e-02,
        -9.8735878836622871e-03, 1.0006225971923594e-01, -9.3452790738751790e-02, 5.1051443038968421e-02,
        5.0026860615357348e-02,
        7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01, 2.4649625448049024e-03,
        3.1680270348929673e-01, -5.5001733936742370e-01, 8.2771855573718722e-01, -1.1279189261064142e-01,
        7.4913663046505957e-02,
        -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03, 3.7868894544552950e-01,
        8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02, -1.2759204810744412e-02,
        1.1067211115661844e-01,
        6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01, 8.0321265478778811e-02,
        6.1291462474183278e-01, -3.9530735044849602e-01, 9.5485358457719272e-01, 4.3415098016043397e-03,
        1.0966443201100005e-01,
        -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01, 4.8320479502455861e-03,
        -3.9530735044850068e-01, 1.5072282978042730e+00, -1.6064934858736262e+00, -3.8316735096194848e-02,
        -1.3486521938326285e-01,
        2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01, 8.8358482079000877e-02,
        9.5485358457719194e-01, -1.6064934858736002e+00, 3.2376910703515325e+00, -1.4525034032219516e-01,
        3.2560773959590766e-01,
        -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01, -1.2759204810745651e-02,
        4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01, 5.4208565638605377e-01,
        -5.8871416085677031e-02,
        2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02, 1.1067211115661857e-01,
        1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01, -5.8871416085678960e-02,
        2.8565566308291979e-01,
        -2.9853856254878872e+00, 6.0245656511998383e-02, -1.0309672908787586e+00, -6.6443248337085328e-04,
        -1.2067563867102040e+00, 2.1703714582496469e+00, -3.6364639353140351e+00, 4.2088521955133733e-02,
        -5.5195467515868679e-01,
        1.3758204925320119e+00, -1.4003084846002259e-01, 5.0742930658954855e-01, 3.9670849226187008e-02,
        6.5843401103130594e-01, -1.0241412579085751e+00, 1.8132296619900770e+00, -9.6198632831316199e-03,
        1.6197494486848449e-01,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,

        0.4214640985177003, -0.06618450883126188, 0., 0., 0., 0., 0., 0., 0.,
        -0.06618450883126693, 0.618811721564516, 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.
    };
};

TEST_F(TriangularSolveTest, triangularSolveTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 0, 0, 1, 4);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_full_column[i], 1e-12);
    }
}


TEST_F(TriangularSolveTest, triangularSolveLowerMatrixTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 0, 0, 3, 2);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_lower_column[i], 1e-12);
    }
}

TEST_F(TriangularSolveTest, triangularSolveTest_Padding) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 6;
    conf::workGroupSize = 6;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 0, 0, 1, 3);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_full_column_padding[i], 1e-12);
    }
}


TEST_F(TriangularSolveTest, triangularSolveMidColumnTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 5, 1);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 5, 1, 2, 3);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_mid_column[i], 1e-12);
    }
}

TEST_F(TriangularSolveTest, triangularSolveMidColumnLowerTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 5, 1);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 5, 1, 3, 2);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_mid_column_lower[i], 1e-12);
    }
}

// GPU optimized kernel

TEST_F(TriangularSolveTest, GPUtriangularSolveTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve_optimizedGPU(queue, A.matrixData.data(), 0, 0, 1, 4);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_full_column[i], 1e-12);
    }
}


TEST_F(TriangularSolveTest, GPUtriangularSolveLowerMatrixTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve_optimizedGPU(queue, A.matrixData.data(), 0, 0, 3, 2);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_lower_column[i], 1e-12);
    }
}

TEST_F(TriangularSolveTest, GPUtriangularSolveTest_Padding) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 6;
    conf::workGroupSize = 6;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve_optimizedGPU(queue, A.matrixData.data(), 0, 0, 1, 3);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_full_column_padding[i], 1e-12);
    }
}


TEST_F(TriangularSolveTest, GPUtriangularSolveMidColumnTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 5, 1);
    queue.wait();
    MatrixMatrixOperations::triangularSolve_optimizedGPU(queue, A.matrixData.data(), 5, 1, 2, 3);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_mid_column[i], 1e-12);
    }
}

TEST_F(TriangularSolveTest, GPUtriangularSolveMidColumnLowerTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 5, 1);
    queue.wait();
    MatrixMatrixOperations::triangularSolve_optimizedGPU(queue, A.matrixData.data(), 5, 1, 3, 2);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_mid_column_lower[i], 1e-12);
    }
}


// SYRK tests
TEST_F(SYRKTest, syrkFullDiagonalExceptFirstBlock) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal(queue, A.matrixData.data(), 0, 0, 1, A.blockCountXY - 1,
                                                          A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_full[i], 1e-12);
    }
}

TEST_F(SYRKTest, syrkLowerDiagonal) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal(queue, A.matrixData.data(), 0, 0, 3, 2,
                                                          A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_lower[i], 1e-12);
    }
}

TEST_F(SYRKTest, syrkLowerDiagonal2) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal(queue, A.matrixData.data(), 9, 2, 3, 2,
                                                          A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_lower2[i], 1e-12);
    }
}

TEST_F(SYRKTest, syrkPadding) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 9;
    conf::workGroupSize = 9;
    conf::workGroupSizeGEMM_xy = 3;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal(queue, A.matrixData.data(), 0, 0, 1, A.blockCountXY - 1,
                                                          A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_padding[i], 1e-12);
    }
}


// SYRK test GPU optimized kernels
TEST_F(SYRKTest, syrkFullDiagonalExceptFirstBlock_optimized) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal_optimizedGPU(queue, A.matrixData.data(), 0, 0, 1,
                                                                       A.blockCountXY - 1,
                                                                       A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_full[i], 1e-12);
    }
}


TEST_F(SYRKTest, syrkLowerDiagonal_optimized) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal_optimizedGPU(queue, A.matrixData.data(), 0, 0, 3,
                                                                       2,
                                                                       A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_lower[i], 1e-12);
    }
}

TEST_F(SYRKTest, syrkLowerDiagonal2_optimized) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal_optimizedGPU(queue, A.matrixData.data(), 9, 2, 3, 2,
                                                                       A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_lower2[i], 1e-12);
    }
}

TEST_F(SYRKTest, syrkPadding_optimized) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 9;
    conf::workGroupSize = 9;
    conf::workGroupSizeGEMM_xy = 3;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal_optimizedGPU(queue, A.matrixData.data(), 0, 0, 1,
                                                                       A.blockCountXY - 1, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_padding[i], 1e-12);
    }
}

// GEMM kernel tests

TEST_F(GEMMTest, gemmFullLowerBlockTriangle) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep(queue, A.matrixData.data(), 0, 0, 2, A.blockCountXY - 2, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_full_lower_triangle[i], 1e-12);
    }
}


TEST_F(GEMMTest, gemmUpperLowerBlockTriangle) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep(queue, A.matrixData.data(), 0, 0, 2, 2, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_upper_lower_triangle[i], 1e-12);
    }
}

TEST_F(GEMMTest, gemmLowerLowerBlockTriangle) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep(queue, A.matrixData.data(), 0, 0, 3, 2, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_lower_lower_triangle[i], 1e-12);
    }
}

// gemm tests with smaller triangle to the right

TEST_F(GEMMTest, gemmFullLowerBlockTriangle2) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep(queue, A.matrixData.data(), 5, 1, 3, 2, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_full_lower_triangle2[i], 1e-12);
    }
}

TEST_F(GEMMTest, gemmUpperLowerBlockTriangle2) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep(queue, A.matrixData.data(), 5, 1, 3, 1, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_upper_lower_triangle2[i], 1e-12);
    }
}


TEST_F(GEMMTest, gemmLowerLowerBlockTriangle2) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep(queue, A.matrixData.data(), 5, 1, 4, 1, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_lower_lower_triangle2[i], 1e-12);
    }
}

// with padding
TEST_F(GEMMTest, gemmFullLowerBlockTriangle_padding) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 9;
    conf::workGroupSize = 9;
    conf::workGroupSizeGEMM_xy = 3;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep(queue, A.matrixData.data(), 0, 0, 2, 1, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_full_lower_triangle_padding[i], 1e-12);
    }
}


// GPU optimized gemm kernels

TEST_F(GEMMTest, gemmFullLowerBlockTriangle_optimizedGPU) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep_optimizedGPU(queue, A.matrixData.data(), 0, 0, 2, A.blockCountXY - 2,
                                                          A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_full_lower_triangle[i], 1e-12);
    }
}

TEST_F(GEMMTest, gemmUpperLowerBlockTriangle_optimizedGPU) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep_optimizedGPU(queue, A.matrixData.data(), 0, 0, 2, 2, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_upper_lower_triangle[i], 1e-12);
    }
}

TEST_F(GEMMTest, gemmLowerLowerBlockTriangle_optimizedGPU) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep_optimizedGPU(queue, A.matrixData.data(), 0, 0, 3, 2, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_lower_lower_triangle[i], 1e-12);
    }
}

// gemm tests with smaller triangle to the right

TEST_F(GEMMTest, gemmFullLowerBlockTriangle2_optimizedGPU) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep_optimizedGPU(queue, A.matrixData.data(), 5, 1, 3, 2, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_full_lower_triangle2[i], 1e-12);
    }
}

TEST_F(GEMMTest, gemmUpperLowerBlockTriangle2_optimizedGPU) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep_optimizedGPU(queue, A.matrixData.data(), 5, 1, 3, 1, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_upper_lower_triangle2[i], 1e-12);
    }
}


TEST_F(GEMMTest, gemmLowerLowerBlockTriangle2_optimizedGPU) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep_optimizedGPU(queue, A.matrixData.data(), 5, 1, 4, 1, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_lower_lower_triangle2[i], 1e-12);
    }
}

// with padding
TEST_F(GEMMTest, gemmFullLowerBlockTriangle_padding_optimizedGPU) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 9;
    conf::workGroupSize = 9;
    conf::workGroupSizeGEMM_xy = 3;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::matrixMatrixStep_optimizedGPU(queue, A.matrixData.data(), 0, 0, 2, 1, A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_gemm_full_lower_triangle_padding[i], 1e-12);
    }
}
