#include <gtest/gtest.h>
#include <sycl/sycl.hpp>
#include <vector>

#include "Configuration.hpp"
#include "MatrixMatrixOperations.hpp"
#include "MatrixParser.hpp"
#include "SymmetricMatrix.hpp"
#include "MatrixOperations.hpp"

using namespace sycl;

class TriangularSolveTest : public ::testing::Test {
public:
    std::string path_A = "../tests/testData/testMatrixSymmetric20x20.txt";

    std::vector<conf::fp_type> reference_full_column = {
        1.6657640408280994e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        -1.8673704908862789e+00, 1.0376999091272154e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        1.9914611183120795e-01, -7.5869480057048314e-02, 5.9538933077101552e-01, 0.0000000000000000e+00,
        1.4735224749454605e+00, -5.1506086185356859e-01, -1.1920226811933260e-01, 8.0032670022472674e-01,
        -1.6028097870197155e+00, 2.2937540805773846e+00, -2.5838392878253846e-01, -1.7678456058083680e+00,
        -2.4922893068182090e+00, 3.6573309033214474e+00, -3.3737020901929760e-01, -2.7892006079771794e+00,
        -1.8204716091385311e+00, 2.6637773760144547e+00, -4.1374001399694221e-01, -1.7996569268810474e+00,
        1.3444541441564642e-01, -2.1901163822870515e-01, 1.4901244473872655e-01, 3.3307759241632728e-01,
        5.8646722039356480e-01, -7.8135245577742296e-01, 5.6755436654384921e-02, 6.0474432381124210e-01,
        -8.9471435579169500e-01, 1.1698757104065882e+00, -1.3467019672969230e-01, -1.0267821967143758e+00,
        -4.9071349202051351e-01, 2.6995600360914063e-01, -1.5726326848222109e-02, -2.3718230775069185e-01,
        -2.7350143773174702e+00, 3.4423929790634196e+00, -3.3240592050653450e-01, -2.6526475747147336e+00,
        -3.5722206981342791e-02, 3.7615235122557218e-02, -5.9272256162488261e-02, 9.7610886223916168e-03,
        -8.8647906300215062e-01, 1.0542276074574974e+00, -1.8694687074331712e-01, -9.4186778643686409e-01,
        2.1996193663961510e+00, -3.2059783234608568e+00, 3.5856979561988456e-01, 2.3658436659232525e+00,
        -3.1172333793482623e+00, 4.3947220929717883e+00, -3.9890460342756434e-01, -3.6433596772293053e+00,
        8.6307987223184876e-02, -5.6806888724720984e-02, 5.5195419879403122e-02, -5.6645212426107795e-02,
        -2.2698441053852081e-01, 3.5422460798628802e-01, 1.0088135795189414e-01, -4.0713237765408905e-01,
        -4.6736411877794154e-01, 6.7754049933561145e-01, 1.8720636928049694e-01, -6.4357622341170828e-01,
        -2.2996269419491103e-01, 2.9813826265979865e-01, -1.4686706642752718e-03, -5.9538819216252127e-02,


        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,


        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,


        3.7868894544552950e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        8.0321265478778811e-02, 6.1291462474183278e-01, -3.9530735044849602e-01, 9.5485358457719272e-01,
        4.8320479502455861e-03, -3.9530735044850068e-01, 1.5072282978042730e+00, -1.6064934858736262e+00,
        8.8358482079000877e-02, 9.5485358457719194e-01, -1.6064934858736002e+00, 3.2376910703515325e+00,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,

        5.4208565638605377e-01, -5.8871416085677031e-02, 1.9311519640299955e-03, 1.4680424197658130e-02,
        -5.8871416085678960e-02, 2.8565566308291979e-01, -2.4285518358815997e-02, -8.0846727331075868e-02,
        1.9311519640275493e-03, -2.4285518358816854e-02, 4.2146409851770028e-01, -6.6184508831261882e-02,
        1.4680424197656186e-02, -8.0846727331080864e-02, -6.6184508831266933e-02, 6.1881172156451603e-01
    };

    std::vector<conf::fp_type> reference_lower_column = {
        1.6657640408280994e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        -1.8673704908862789e+00, 1.0376999091272154e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        1.9914611183120795e-01, -7.5869480057048314e-02, 5.9538933077101552e-01, 0.0000000000000000e+00,
        1.4735224749454605e+00, -5.1506086185356859e-01, -1.1920226811933260e-01, 8.0032670022472674e-01,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -3.5722206981342791e-02, 3.7615235122557218e-02, -5.9272256162488261e-02, 9.7610886223916168e-03,
        -8.8647906300215062e-01, 1.0542276074574974e+00, -1.8694687074331712e-01, -9.4186778643686409e-01,
        2.1996193663961510e+00, -3.2059783234608568e+00, 3.5856979561988456e-01, 2.3658436659232525e+00,
        -3.1172333793482623e+00, 4.3947220929717883e+00, -3.9890460342756434e-01, -3.6433596772293053e+00,
        8.6307987223184876e-02, -5.6806888724720984e-02, 5.5195419879403122e-02, -5.6645212426107795e-02,
        -2.2698441053852081e-01, 3.5422460798628802e-01, 1.0088135795189414e-01, -4.0713237765408905e-01,
        -4.6736411877794154e-01, 6.7754049933561145e-01, 1.8720636928049694e-01, -6.4357622341170828e-01,
        -2.2996269419491103e-01, 2.9813826265979865e-01, -1.4686706642752718e-03, -5.9538819216252127e-02,


        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,


        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,


        3.7868894544552950e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        8.0321265478778811e-02, 6.1291462474183278e-01, -3.9530735044849602e-01, 9.5485358457719272e-01,
        4.8320479502455861e-03, -3.9530735044850068e-01, 1.5072282978042730e+00, -1.6064934858736262e+00,
        8.8358482079000877e-02, 9.5485358457719194e-01, -1.6064934858736002e+00, 3.2376910703515325e+00,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,

        5.4208565638605377e-01, -5.8871416085677031e-02, 1.9311519640299955e-03, 1.4680424197658130e-02,
        -5.8871416085678960e-02, 2.8565566308291979e-01, -2.4285518358815997e-02, -8.0846727331075868e-02,
        1.9311519640275493e-03, -2.4285518358816854e-02, 4.2146409851770028e-01, -6.6184508831261882e-02,
        1.4680424197656186e-02, -8.0846727331080864e-02, -6.6184508831266933e-02, 6.1881172156451603e-01
    };

    std::vector<conf::fp_type> reference_full_column_padding = {
        1.6657640408280994e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,
        -1.8673704908862789e+00, 1.0376999091272154e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,
        1.9914611183120795e-01, -7.5869480057048314e-02, 5.9538933077101552e-01, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00,
        1.4735224749454605e+00, -5.1506086185356859e-01, -1.1920226811933260e-01, 8.0032670022472674e-01,
        0.0000000000000000e+00, 0.0000000000000000e+00,
        -1.6028097870197007e+00, 7.9773869098677519e-01, -8.5136393747017217e-02, -2.2778431498642401e-01,
        7.4762315235152865e-01, 0.0000000000000000e+00,
        2.4420704350067937e-01, -3.0887263662396268e-02, 1.3677303345587569e-01, 5.9250512704066470e-02,
        -2.0228166224241897e-01, 6.8724782398450568e-01,
        -7.2879110517901224e-01, 1.0597521609141103e+00, -1.6340636237002437e-01, -7.2755857517684763e-01,
        9.2430629838861744e-01, -1.7220207379443564e-01,
        -2.0375967573825484e+00, 2.8739435192899205e+00, -3.3105059124081909e-01, -1.9715521617265894e+00,
        2.5673778891636849e+00, -3.8663424699955912e-01,
        1.6249208127196311e+00, -2.1742911385383117e+00, 1.7125982229607620e-01, 1.6840596910959287e+00,
        -2.0450991506774616e+00, 1.9184411726440062e-01,
        -2.2559519868365179e+00, 2.9145112868829970e+00, -1.9372635519430351e-01, -2.4207929148369378e+00,
        2.8855875937503614e+00, -3.5857782432674040e-01,
        -3.4329760692023155e-02, -2.6609448312806067e-01, -2.0341983577650151e-02, 7.4529053021896913e-02,
        -1.1816217109305892e-01, 1.1564720577987701e-01,
        -1.1435308352499149e+00, 1.2656328631995890e+00, -1.4193624078721315e-01, -9.1640614435575585e-01,
        1.3617416603569541e+00, -1.8422765261556656e-01,
        -3.5722206981342791e-02, 3.7615235122557218e-02, -5.9272256162488261e-02, 9.7610886223916168e-03,
        2.6952660345748148e-03, -4.8416033462949010e-02,
        -8.8647906300215062e-01, 1.0542276074574974e+00, -1.8694687074331712e-01, -9.4186778643686409e-01,
        9.6693378656021922e-01, -2.6395278371405911e-01,
        2.1996193663961510e+00, -3.2059783234608568e+00, 3.5856979561988456e-01, 2.3658436659232525e+00,
        -3.1198006472028079e+00, 4.6199293783571604e-01,
        -3.1172333793482623e+00, 4.3947220929717883e+00, -3.9890460342756434e-01, -3.6433596772293053e+00,
        3.9145638514000498e+00, -7.1733086625876075e-01,
        3.6235137387979421e-01, -1.9693294410818493e-01, 1.1468113651606157e-01, 5.9082165776128043e-02,
        -2.0398258722085091e-01, 7.6676085739335015e-02,
        -6.6674912845583900e-01, 9.2441263507927385e-01, 1.1793733026057197e-02, -6.4596861604028577e-01,
        7.5199870108758460e-01, -5.0123571046363615e-03,
        -1.4639199469107816e-01, 2.1924634442345384e-01, 6.8916610752103744e-02, -2.1826030581017944e-01,
        2.2781242465460863e-01, -3.7618249088916145e-02,
        -1.5188877416842050e-01, 2.9016514284874140e-01, 1.2968456143277046e-01, -2.4311234264164150e-01,
        1.9728718882511051e-01, -7.1684777180287249e-02,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,


        1.2025252268184892e+00, 4.1705809958244894e-01, -5.6172013402170251e-01, 1.1991260426896690e+00,
        -1.1699354606422368e-02, 4.2401421263562933e-01,
        4.1705809958245399e-01, 6.4400883451936553e-01, -3.0917013285923317e-01, 6.3979373238595694e-01,
        -2.7705208888286797e-02, 1.8968539503475218e-01,
        -5.6172013402169785e-01, -3.0917013285922595e-01, 8.7437568791152032e-01, -9.1868391894345802e-01,
        1.9199872942222414e-02, -3.0485646763521551e-01,
        1.1991260426896397e+00, 6.3979373238592463e-01, -9.1868391894344226e-01, 2.3375001311373147e+00,
        1.7705425733133173e-02, 7.1228259711908515e-01,
        -1.1699354606433503e-02, -2.7705208888295679e-02, 1.9199872942229981e-02, 1.7705425733118188e-02,
        4.1648904069244608e-01, 1.5919695681616410e-02,
        4.2401421263563355e-01, 1.8968539503475143e-01, -3.0485646763521962e-01, 7.1228259711910491e-01,
        1.5919695681622468e-02, 7.9464265632871822e-01,
        -1.2808413323261096e-02, 2.5652730179867012e-02, 1.8059926955854736e-02, -9.0031534990619132e-04,
        -5.8949311819491042e-02, 2.4649625448028437e-03,
        4.4057696635745036e-01, 2.9339009605742905e-01, -3.5076249947980853e-01, 6.8780733199268662e-01,
        -9.8735878836572373e-03, 3.1680270348929285e-01,
        -7.1324932560104082e-01, -5.8240859554991919e-01, 6.3142354939312706e-01, -1.2381324707014414e+00,
        1.0006225971922125e-01, -5.5001733936741626e-01,
        1.2307058485183657e+00, 7.7925883154646780e-01, -1.1064181741274410e+00, 2.2420636674640244e+00,
        -9.3452790738735789e-02, 8.2771855573717035e-01,
        -4.4341279224073042e-02, -3.4565675343943537e-02, 7.2517465362718969e-02, -9.1395038026401379e-02,
        5.1051443038971196e-02, -1.1279189261063732e-01,
        1.7864711950652662e-01, 1.5436479167763201e-01, -1.0855336182283683e-01, 2.7696135750196627e-01,
        5.0026860615359554e-02, 7.4913663046502502e-02,
        1.1086531578325651e-02, 2.4380787948738807e-02, -9.1788861387306867e-02, 3.7404010142305244e-01,
        2.4631811701543577e-02, 1.7866073490049519e-01,
        -2.1049381211188517e-02, -6.4323645432827578e-02, 8.3036032711741647e-02, -2.0358580926964912e-01,
        -1.3026138476656304e-01, -6.2021809656662992e-02,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,

        3.7868894544552950e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        -1.2759204810744412e-02, 1.1067211115661844e-01,
        8.0321265478778811e-02, 6.1291462474183278e-01, -3.9530735044849602e-01, 9.5485358457719272e-01,
        4.3415098016043397e-03, 1.0966443201100005e-01,
        4.8320479502455861e-03, -3.9530735044850068e-01, 1.5072282978042730e+00, -1.6064934858736262e+00,
        -3.8316735096194848e-02, -1.3486521938326285e-01,
        8.8358482079000877e-02, 9.5485358457719194e-01, -1.6064934858736002e+00, 3.2376910703515325e+00,
        -1.4525034032219516e-01, 3.2560773959590766e-01,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        5.4208565638605377e-01, -5.8871416085677031e-02,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        -5.8871416085678960e-02, 2.8565566308291979e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        1.9311519640275493e-03, -2.4285518358816854e-02,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,
        1.4680424197656186e-02, -8.0846727331080864e-02,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,

        4.2146409851770028e-01, -6.6184508831261882e-02, 0, 0, 0, 0,
        -6.6184508831266933e-02, 6.1881172156451603e-01, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0,
        0, 0, 0, 0, 0, 0

    };

    std::vector<conf::fp_type> reference_mid_column = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,

        1.9553671036635423e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        -3.0297561916737892e-01, 7.1009985616774174e-01, 0.0000000000000000e+00, 0.0000000000000000e+00,
        7.8741029839458598e-01, -6.7993112755269383e-02, 7.6018891429597113e-01, 0.0000000000000000e+00,
        4.7977972748514841e-01, 9.2545164633151433e-02, 5.9941725216754331e-02, 6.3376859317475198e-01,
        -6.2819090720941551e-01, 5.5878155172176147e-02, -2.8727093391786568e-01, -1.5811360039757758e-01,
        3.3833226983269888e+00, -4.8939792992121861e-01, 1.5661036176218888e+00, 8.3352948358697787e-01,
        9.4683849173368473e-01, 5.5388026835991894e-02, 4.2224372259702919e-01, 2.0188314990821143e-01,
        1.4657794299168214e+00, -2.5239324815744973e-01, 6.1788427656807599e-01, 2.7818473408282340e-01,
        2.2960789472464219e-03, -4.1245292196542813e-02, -6.5503880571906280e-03, 1.3119137645204575e-02,
        1.4069143789436591e+00, -2.7600262658576141e-01, 6.1764884849720481e-01, 4.1876487134252094e-01,
        -2.4158041047824277e+00, 3.9353435208564919e-01, -8.7622379419223984e-01, -7.4227024613381942e-01,
        4.7718707305686845e+00, -8.5649208034207303e-01, 1.9395258090781304e+00, 1.2286863672603101e+00,
        -5.8962225190327712e-03, 2.4765410180960339e-02, -2.2676703080969290e-02, -1.7677332956651404e-02,
        4.6798006543902199e-01, 7.8349750645332009e-03, 2.4190489528745601e-01, 2.0984230525553482e-01,
        5.4715861401168875e-01, -1.0738244106636050e-01, 5.9709194761522831e-02, 6.9151144538467491e-02,
        -4.6383386612409150e-01, -1.6268430841780465e-02, -5.7017276780749707e-02, -1.2529391625051406e-01,

        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,

        3.7868894544552950e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        8.0321265478778811e-02, 6.1291462474183278e-01, -3.9530735044849602e-01, 9.5485358457719272e-01,
        4.8320479502455861e-03, -3.9530735044850068e-01, 1.5072282978042730e+00, -1.6064934858736262e+00,
        8.8358482079000877e-02, 9.5485358457719194e-01, -1.6064934858736002e+00, 3.2376910703515325e+00,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,

        5.4208565638605377e-01, -5.8871416085677031e-02, 1.9311519640299955e-03, 1.4680424197658130e-02,
        -5.8871416085678960e-02, 2.8565566308291979e-01, -2.4285518358815997e-02, -8.0846727331075868e-02,
        1.9311519640275493e-03, -2.4285518358816854e-02, 4.2146409851770028e-01, -6.6184508831261882e-02,
        1.4680424197656186e-02, -8.0846727331080864e-02, -6.6184508831266933e-02, 6.1881172156451603e-01

    };

    std::vector<conf::fp_type> reference_mid_column_lower = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,

        1.9553671036635423e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        -3.0297561916737892e-01, 7.1009985616774174e-01, 0.0000000000000000e+00, 0.0000000000000000e+00,
        7.8741029839458598e-01, -6.7993112755269383e-02, 7.6018891429597113e-01, 0.0000000000000000e+00,
        4.7977972748514841e-01, 9.2545164633151433e-02, 5.9941725216754331e-02, 6.3376859317475198e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        2.2960789472464219e-03, -4.1245292196542813e-02, -6.5503880571906280e-03, 1.3119137645204575e-02,
        1.4069143789436591e+00, -2.7600262658576141e-01, 6.1764884849720481e-01, 4.1876487134252094e-01,
        -2.4158041047824277e+00, 3.9353435208564919e-01, -8.7622379419223984e-01, -7.4227024613381942e-01,
        4.7718707305686845e+00, -8.5649208034207303e-01, 1.9395258090781304e+00, 1.2286863672603101e+00,
        -5.8962225190327712e-03, 2.4765410180960339e-02, -2.2676703080969290e-02, -1.7677332956651404e-02,
        4.6798006543902199e-01, 7.8349750645332009e-03, 2.4190489528745601e-01, 2.0984230525553482e-01,
        5.4715861401168875e-01, -1.0738244106636050e-01, 5.9709194761522831e-02, 6.9151144538467491e-02,
        -4.6383386612409150e-01, -1.6268430841780465e-02, -5.7017276780749707e-02, -1.2529391625051406e-01,

        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,

        3.7868894544552950e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        8.0321265478778811e-02, 6.1291462474183278e-01, -3.9530735044849602e-01, 9.5485358457719272e-01,
        4.8320479502455861e-03, -3.9530735044850068e-01, 1.5072282978042730e+00, -1.6064934858736262e+00,
        8.8358482079000877e-02, 9.5485358457719194e-01, -1.6064934858736002e+00, 3.2376910703515325e+00,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,

        5.4208565638605377e-01, -5.8871416085677031e-02, 1.9311519640299955e-03, 1.4680424197658130e-02,
        -5.8871416085678960e-02, 2.8565566308291979e-01, -2.4285518358815997e-02, -8.0846727331075868e-02,
        1.9311519640275493e-03, -2.4285518358816854e-02, 4.2146409851770028e-01, -6.6184508831261882e-02,
        1.4680424197656186e-02, -8.0846727331080864e-02, -6.6184508831266933e-02, 6.1881172156451603e-01

    };
};


class SYRKTest : public ::testing::Test {
public:
    std::string path_A = "../tests/testData/testMatrixSymmetric20x20.txt";

    std::vector<conf::fp_type> reference_syrk_full = {

        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,


        -2.6761016441162539e+01, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        3.6136790216859449e+00, 9.2628966256078638e-03, -2.8684802228278411e-01, -7.9645251903748354e-02,
        -1.2132605863495639e+01, 1.5977378004280804e+00, -4.9304215684646389e+00, 4.1705809958244894e-01,
        -6.9475915259183525e+00, 1.0012834150516008e+00, -3.1122364225934165e+00, -1.4042305365654300e+00,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,


        -2.7977334563427139e+00, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        6.7714724920818767e+00, -1.3780077309848497e+01, 1.7705425733133173e-02, 7.1228259711908515e-01,
        -4.3329375807296774e-02, 1.5208829047502470e-01, 3.9453002610056070e-01, 1.5919695681616410e-02,
        2.4333379452442161e+00, -5.0158675100252754e+00, 5.0273925682839143e-02, -1.2605718128670511e+00,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,


        3.6120939053841011e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        -2.6630222265130274e-02, -2.1612143244654631e+00, -3.9530735044849602e-01, 9.5485358457719272e-01,
        2.0770104730869965e-01, 4.2951574536390922e+00, -6.5375169229229613e+00, -1.6064934858736262e+00,
        -2.5641938975454004e-01, -7.2614641873315549e+00, 1.2451689881932804e+01, -2.1345547755011765e+01,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,

        4.9510517989510350e-01, -5.8871416085677031e-02, 1.9311519640299955e-03, 1.4680424197658130e-02,
        1.2952186867610641e-02, -1.9637973981109119e-01, -2.4285518358815997e-02, -8.0846727331075868e-02,
        2.6688254606924127e-02, -4.0934055847789486e-01, 8.3256737128770519e-02, -6.6184508831261882e-02,
        1.9023033689042762e-03, 6.5548681403913511e-02, 5.7384121131461727e-02, 5.6953073798942577e-01
    };


    std::vector<conf::fp_type> reference_syrk_lower = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,


        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,

        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,

        3.6120939053841011e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        -2.6630222265130274e-02, -2.1612143244654631e+00, -3.9530735044849602e-01, 9.5485358457719272e-01,
        2.0770104730869965e-01, 4.2951574536390922e+00, -6.5375169229229613e+00, -1.6064934858736262e+00,
        -2.5641938975454004e-01, -7.2614641873315549e+00, 1.2451689881932804e+01, -2.1345547755011765e+01,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,

        4.9510517989510350e-01, -5.8871416085677031e-02, 1.9311519640299955e-03, 1.4680424197658130e-02,
        1.2952186867610641e-02, -1.9637973981109119e-01, -2.4285518358815997e-02, -8.0846727331075868e-02,
        2.6688254606924127e-02, -4.0934055847789486e-01, 8.3256737128770519e-02, -6.6184508831261882e-02,
        1.9023033689042762e-03, 6.5548681403913511e-02, 5.7384121131461727e-02, 5.6953073798942577e-01
    };

    std::vector<conf::fp_type> reference_syrk_lower2 = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,


        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,


        8.7437568791152032e-01, -9.1868391894345802e-01, 1.9199872942222414e-02, -3.0485646763521551e-01,
        -9.1868391894344226e-01, 2.3375001311373147e+00, 1.7705425733133173e-02, 7.1228259711908515e-01,
        1.9199872942229981e-02, 1.7705425733118188e-02, 4.1648904069244608e-01, 1.5919695681616410e-02,
        -3.0485646763521962e-01, 7.1228259711910491e-01, 1.5919695681622468e-02, 7.9464265632871822e-01,
        1.8059926955854736e-02, -9.0031534990619132e-04, -5.8949311819491042e-02, 2.4649625448028437e-03,
        -3.5076249947980853e-01, 6.8780733199268662e-01, -9.8735878836572373e-03, 3.1680270348929285e-01,
        6.3142354939312706e-01, -1.2381324707014414e+00, 1.0006225971922125e-01, -5.5001733936741626e-01,
        -1.1064181741274410e+00, 2.2420636674640244e+00, -9.3452790738735789e-02, 8.2771855573717035e-01,
        7.2517465362718969e-02, -9.1395038026401379e-02, 5.1051443038971196e-02, -1.1279189261063732e-01,
        -1.0855336182283683e-01, 2.7696135750196627e-01, 5.0026860615359554e-02, 7.4913663046502502e-02,
        -9.1788861387306867e-02, 3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01,
        8.3036032711741647e-02, -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02,


        3.7488087651181057e-01, 8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02,
        8.5912306087883986e-02, -8.3660072918208872e-02, -3.9530735044849602e-01, 9.5485358457719272e-01,
        -4.3175140850654214e-04, 8.5300389688647682e-01, -7.3697094535412577e-01, -1.6064934858736262e+00,
        1.0280960488246765e-01, -1.2384904394539249e+00, 2.3327074880041634e+00, -3.7071710262586839e+00,
        -1.2759204810745651e-02, 4.3415098016097468e-03, -3.8316735096207977e-02, -1.4525034032217446e-01,
        1.1067211115661857e-01, 1.0966443201099842e-01, -1.3486521938325929e-01, 3.2560773959590406e-01,
        2.5066823380845250e-02, 1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01,
        2.7403160827504044e-02, 1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02,


        5.1314555975252241e-01, -5.8871416085677031e-02, 1.9311519640299955e-03, 1.4680424197658130e-02,
        -1.9790797216661736e-02, 1.8904949347647457e-01, -2.4285518358815997e-02, -8.0846727331075868e-02,
        6.1666849725930069e-02, -1.5246054439527423e-01, 2.4060652162746937e-01, -6.6184508831261882e-02,
        -1.0293396837934432e-02, -4.2846356348977127e-03, 3.1875966807647094e-02, 5.4965482386564268e-01


    };

    std::vector<conf::fp_type> reference_syrk_padding = {
        2.7747698397159577e+00, -3.1105986146218796e+00, 3.3173043195915752e-01, 2.4545407521161722e+00,
        -2.6699029075047620e+00, 4.0679131158037513e-01, -1.2139940162825444e+00, -7.5349096614206290e-01,
        9.7691600685599578e-01,
        -3.1105986146219244e+00, 4.5638936516354933e+00, -4.5060932516906471e-01, -3.2860909969113026e+00,
        3.8208530659285511e+00, -4.8807673739540747e-01, 1.7652970418405887e+00, 1.0033410158599028e+00,
        -1.3015488240467616e+00,
        3.3173043195915058e-01, -4.5060932516905167e-01, 3.9990380705757250e-01, 2.6155191272589584e-01,
        -4.3040665729383115e-01, 1.3240948868622146e-01, -2.7219644247850666e-01, -3.8390949334249039e-02,
        9.4541165500368077e-02,
        2.4545407521161948e+00, -3.2860909969112888e+00, 2.6155191272590356e-01, 3.0912881834001289e+00,
        -2.9448136398915512e+00, 4.0686949929405408e-01, -1.2119409121257083e+00, -6.8725808538671529e-01,
        1.0073613484996695e+00,
        -2.6699029075047869e+00, 3.8208530659285262e+00, -4.3040665729384114e-01, -2.9448136398915463e+00,
        3.8234605100895505e+00, -5.9242855893198609e-01, 1.5396761945666670e+00, 9.3814549612911824e-01,
        -1.2283438347778430e+00,
        4.0679131158035214e-01, -4.8807673739537333e-01, 1.3240948868621941e-01, 4.0686949929403021e-01,
        -5.9242855893195390e-01, 5.9603603153930418e-01, -2.8684802228278411e-01, -7.9645251903748354e-02,
        1.0926230643706929e-01,
        -1.2139940162825678e+00, 1.7652970418405984e+00, -2.7219644247851249e-01, -1.2119409121257203e+00,
        1.5396761945666864e+00, -2.8684802228279765e-01, 1.2025252268184892e+00, 4.1705809958244894e-01,
        -5.6172013402170251e-01,
        -7.5349096614209388e-01, 1.0033410158599234e+00, -3.8390949334255277e-02, -6.8725808538673538e-01,
        9.3814549612914633e-01, -7.9645251903761358e-02, 4.1705809958245399e-01, 6.4400883451936553e-01,
        -3.0917013285923317e-01,
        9.7691600685600810e-01, -1.3015488240467590e+00, 9.4541165500371449e-02, 1.0073613484996713e+00,
        -1.2283438347778477e+00, 1.0926230643708006e-01, -5.6172013402169785e-01, -3.0917013285922595e-01,
        8.7437568791152032e-01,
        -2.0235965869348997e+00, 2.6730544372793390e+00, -2.4573067851430980e-01, -2.1947734970400403e+00,
        2.5928234905181404e+00, -3.6445111830706883e-01, 1.1991260426896397e+00, 6.3979373238592463e-01,
        -9.1868391894344226e-01,
        -1.0749139798307422e-01, -8.3632241091293427e-02, 1.2156695122416124e-02, 5.7118096653145975e-02,
        -4.9105063646760604e-03, 1.1938008745463984e-01, -1.1699354606433503e-02, -2.7705208888295679e-02,
        1.9199872942229981e-02,
        -8.0540589314453237e-01, 9.6896204978251843e-01, -1.1116496058549900e-01, -6.7475233538173995e-01,
        9.9743699375318839e-01, -1.7512106586145490e-01, 4.2401421263563355e-01, 1.8968539503475143e-01,
        -3.0485646763521962e-01,
        -5.9504767848539315e-02, 6.2658106054449964e-02, -9.8733592934224665e-02, 1.6259670426516246e-02,
        4.4896772408600715e-03, -8.0649687542110424e-02, -1.2808413323261096e-02, 2.5652730179867012e-02,
        1.8059926955854736e-02,
        -8.5319264793421956e-01, 1.0237303123824344e+00, -8.3311488695874486e-02, -9.9560368524776532e-01,
        9.9835404218752077e-01, -1.8349310749948108e-01, 4.4057696635745036e-01, 2.9339009605742905e-01,
        -3.5076249947980853e-01,
        1.3697726694746379e+00, -1.9812980610910540e+00, 2.1586835317618766e-01, 1.4820009790487283e+00,
        -1.9303200313618414e+00, 2.8544976172450259e-01, -7.1324932560104082e-01, -5.8240859554991919e-01,
        6.3142354939312706e-01,
        -2.3530515264344296e+00, 3.4118088330373277e+00, -3.5304632311288203e-01, -2.6983895419032513e+00,
        3.0107590688535986e+00, -5.6456001639430486e-01, 1.2307058485183657e+00, 7.7925883154646780e-01,
        -1.1064181741274410e+00,
        1.4376874155263242e-01, -9.4626872508963428e-02, 9.1942545653518157e-02, -9.4357557944479392e-02,
        -1.1529279549596864e-02, 4.8425468376584020e-02, -4.4341279224073042e-02, -3.4565675343943537e-02,
        7.2517465362718969e-02,
        -3.9671069065748304e-01, 4.7365835120159905e-01, 1.6142776644353493e-03, -3.1670363315989691e-01,
        3.3409898882607247e-01, -1.9397008171076996e-03, 1.7864711950652662e-01, 1.5436479167763201e-01,
        -1.0855336182283683e-01,
        -2.4385452062149604e-01, 3.6521267662360168e-01, 1.1479881200660158e-01, -3.6357016895874122e-01,
        3.7948174504350779e-01, -6.2663126611230927e-02, 1.1086531578325651e-02, 2.4380787948738807e-02,
        -9.1788861387306867e-02,
        1.1575312383608603e-01, -1.0830981144502275e-01, 5.8808123636141353e-03, 1.5529519853480828e-01,
        -2.2068530134148900e-01, -4.1400784983371174e-03, -2.1049381211188517e-02, -6.4323645432827578e-02,
        8.3036032711741647e-02,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,

        -2.3326855009648551e+01, 1.7705425733133173e-02, 7.1228259711908515e-01, -9.0031534989483994e-04,
        6.8780733199268096e-01, -1.2381324707014076e+00, 2.2420636674640124e+00, -9.1395038026422237e-02,
        2.7696135750196771e-01,
        2.5772180741432865e-01, 3.7898121912837679e-01, 1.5919695681616410e-02, -5.8949311819489487e-02,
        -9.8735878836622871e-03, 1.0006225971923594e-01, -9.3452790738751790e-02, 5.1051443038968421e-02,
        5.0026860615357348e-02,
        -8.5757413921453640e+00, 9.2146986115219667e-02, -2.5948258245484315e+00, 2.4649625448049024e-03,
        3.1680270348929673e-01, -5.5001733936742370e-01, 8.2771855573718722e-01, -1.1279189261064142e-01,
        7.4913663046505957e-02,
        -3.0287406692144825e-01, -4.9969642793138730e-02, -1.1870926324660176e-01, 3.5353658225685164e-01,
        8.0321265478775369e-02, 4.8320479502505205e-03, 8.8358482078989248e-02, -1.2759204810744412e-02,
        1.1067211115661844e-01,
        -9.6744804301165814e+00, 8.8737524408881704e-02, -3.4206904265879965e+00, -4.1459591438957666e-02,
        -3.5948149813080854e+00, -3.9530735044849602e-01, 9.5485358457719272e-01, 4.3415098016043397e-03,
        1.0966443201100005e-01,
        1.7052541827858718e+01, -8.5832105976901579e-02, 6.0777455741863680e+00, 2.3379031052412780e-01,
        6.9812721638169570e+00, -1.1591753984237300e+01, -1.6064934858736262e+00, -3.8316735096194848e-02,
        -1.3486521938326285e-01,
        -2.8651528576111474e+01, 2.3678303812599422e-01, -1.0342205669914298e+01, -2.9971321109604471e-01,
        -1.1529798022438870e+01, 2.0454837593044612e+01, -3.4074988325967070e+01, -1.4525034032219516e-01,
        3.2560773959590766e-01,
        4.5742573218429450e-01, 5.4156904281077209e-02, 1.0868835859945525e-01, 1.5303266084480672e-02,
        2.1310290180017957e-01, -4.3636596666930194e-01, 5.1753253328712379e-01, 4.8420751188283595e-01,
        -5.8871416085677031e-02,
        -3.7663065625174297e+00, 7.5390000169819074e-02, -1.3887787290914149e+00, 6.1328619224362196e-02,
        -1.5248597941375970e+00, 2.7473413639507682e+00, -4.5451687922912800e+00, 3.8027218165876980e-02,
        -3.7553275116565277e-01,
        3.7404010142305244e-01, 2.4631811701543577e-02, 1.7866073490049519e-01, 2.5066823380845250e-02,
        1.6217455364931904e-01, -2.3175196220581837e-01, 4.3600406503834038e-01, 1.9311519640275493e-03,
        -2.4285518358816854e-02,
        -2.0358580926964912e-01, -1.3026138476656304e-01, -6.2021809656662992e-02, 2.7403160827504044e-02,
        1.6857742311369241e-02, 1.1014382533047898e-01, -7.9794803587211929e-02, 1.4680424197656186e-02,
        -8.0846727331080864e-02,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00, 0.0000000000000000e+00,
        0.0000000000000000e+00,

        -0.07381885420740736, -0.06618450883126188, 0., 0., 0., 0., 0., 0., 0.,
        0.1502941428124802, 0.5093360049716221, 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.,
        0., 0., 0., 0., 0., 0., 0., 0., 0.
    };
};

TEST_F(TriangularSolveTest, triangularSolveTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 0, 0, 1, 4);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_full_column[i], 1e-12);
    }
}


TEST_F(TriangularSolveTest, triangularSolveLowerMatrixTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 0, 0, 3, 2);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_lower_column[i], 1e-12);
    }
}

TEST_F(TriangularSolveTest, triangularSolveTest_Padding) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 6;
    conf::workGroupSize = 6;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 0, 0, 1, 3);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_full_column_padding[i], 1e-12);
    }
}


TEST_F(TriangularSolveTest, triangularSolveMidColumnTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 5, 1);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 5, 1, 2, 3);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_mid_column[i], 1e-12);
    }
}

TEST_F(TriangularSolveTest, triangularSolveMidColumnLowerTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 5, 1);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 5, 1, 3, 2);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_mid_column_lower[i], 1e-12);
    }
}

// GPU optimized kernel

TEST_F(TriangularSolveTest, GPUtriangularSolveTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve(queue, A.matrixData.data(), 0, 0, 1, 4);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_full_column[i], 1e-12);
    }
}


TEST_F(TriangularSolveTest, GPUtriangularSolveLowerMatrixTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve_optimizedGPU(queue, A.matrixData.data(), 0, 0, 3, 2);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_lower_column[i], 1e-12);
    }
}

TEST_F(TriangularSolveTest, GPUtriangularSolveTest_Padding) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 6;
    conf::workGroupSize = 6;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 0, 0);
    queue.wait();
    MatrixMatrixOperations::triangularSolve_optimizedGPU(queue, A.matrixData.data(), 0, 0, 1, 3);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_full_column_padding[i], 1e-12);
    }
}


TEST_F(TriangularSolveTest, GPUtriangularSolveMidColumnTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 5, 1);
    queue.wait();
    MatrixMatrixOperations::triangularSolve_optimizedGPU(queue, A.matrixData.data(), 5, 1, 2, 3);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_mid_column[i], 1e-12);
    }
}

TEST_F(TriangularSolveTest, GPUtriangularSolveMidColumnLowerTest) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixOperations::cholesky(queue, A.matrixData.data(), 5, 1);
    queue.wait();
    MatrixMatrixOperations::triangularSolve_optimizedGPU(queue, A.matrixData.data(), 5, 1, 3, 2);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_mid_column_lower[i], 1e-12);
    }
}


// SYRK tests
TEST_F(SYRKTest, syrkFullDiagonalExceptFirstBlock) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal(queue, A.matrixData.data(), 0, 0, 1, A.blockCountXY - 1,
                                                          A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_full[i], 1e-12);
    }
}

TEST_F(SYRKTest, syrkLowerDiagonal) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal(queue, A.matrixData.data(), 0, 0, 3, 2,
                                                          A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_lower[i], 1e-12);
    }
}

TEST_F(SYRKTest, syrkLowerDiagonal2) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal(queue, A.matrixData.data(), 9, 2, 1, 2,
                                                          A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_lower2[i], 1e-12);
    }
}

TEST_F(SYRKTest, syrkPadding) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 9;
    conf::workGroupSize = 9;
    conf::workGroupSizeGEMM_xy = 3;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal(queue, A.matrixData.data(), 0, 0, 1, A.blockCountXY - 1,
                                                          A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_padding[i], 1e-12);
    }
}


// SYRK test GPU optimized kernels
TEST_F(SYRKTest, syrkFullDiagonalExceptFirstBlock_optimized) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal_optimizedGPU(queue, A.matrixData.data(), 0, 0, 1,
                                                                       A.blockCountXY - 1,
                                                                       A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_full[i], 1e-12);
    }
}


TEST_F(SYRKTest, syrkLowerDiagonal_optimized) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal_optimizedGPU(queue, A.matrixData.data(), 0, 0, 3,
                                                                       A.blockCountXY - 1,
                                                                       A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_lower[i], 1e-12);
    }
}

TEST_F(SYRKTest, syrkLowerDiagonal2_optimized) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 4;
    conf::workGroupSize = 4;
    conf::workGroupSizeGEMM_xy = 2;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal_optimizedGPU(queue, A.matrixData.data(), 9, 2, 1, 2,
                                                                       A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_lower2[i], 1e-12);
    }
}

TEST_F(SYRKTest, syrkPadding_optimized) {
    queue queue(cpu_selector_v);
    conf::matrixBlockSize = 9;
    conf::workGroupSize = 9;
    conf::workGroupSizeGEMM_xy = 3;
    SymmetricMatrix A = MatrixParser::parseSymmetricMatrix(path_A, queue);
    queue.wait();

    MatrixMatrixOperations::symmetricMatrixMatrixDiagonal_optimizedGPU(queue, A.matrixData.data(), 0, 0, 1, A.blockCountXY - 1,
                                                          A.blockCountXY);
    queue.wait();


    for (size_t i = 0; i < A.matrixData.size(); i++) {
        EXPECT_NEAR(A.matrixData[i], reference_syrk_padding[i], 1e-12);
    }
}

